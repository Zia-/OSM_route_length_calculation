create table ways_new ();
select addgeometrycolumn('ways_new', 'the_geom', 4326, 'LINESTRING', 2);
alter table ways_new add column length double precision;
insert into ways_new (the_geom, length) select the_geom, length from ways;
create index the_geom_idx1 on ways_new using gist(the_geom);
alter table ways_new add column z_id BIGSERIAL;
alter table dem add column the_geom_st_envelope geometry;
update dem set the_geom_st_envelope = st_envelope(rast);
create index the_geom_st_envelope_idx on dem using gist(the_geom_st_envelope);
create table ways_new_split (the_geom geometry, z_id bigserial);
